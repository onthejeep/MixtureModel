Traveltime = [3.82371016,3.69024781,3.55131291,5.16093999,4.11502671
,4.89527333,3.46792928,4.95218788,5.69964306,5.45113731
,2.78296871,2.28874201,3.72048284,4.80621287,3.94261533
,3.24939139,5.33275141,3.8936405, 4.71077051,3.543074
,3.92405279,4.2632726, 3.55034841,3.92414084,2.68468112
,4.04336137,5.5612573, 4.82418221,3.29918703,3.60219205
,3.83303382,5.13677806,4.17604853,4.0257285, 4.89923438
,4.81335735,3.94777934,2.90616947,5.42168891,4.83822501
,4.91449306,3.22818989,3.76151302,5.32343843,3.95242393
,3.90905958,2.91557951,2.85535903,2.54985753,4.65974557
,2.70136958,3.8761431, 4.97513553,3.29110147,5.18687886
,4.38610715,4.10099073,3.81343185,4.04904104,2.73833875
,4.12961311,3.54921046,2.72957599,3.76362689,4.11653306
,4.03783611,4.84984873,3.8677683, 4.51268389,3.83219738
,5.20384815,4.64924372,4.14137661,5.88620122,3.87063324
,2.55043617,4.03533835,2.94464121,5.12708846,5.21541307
,3.85943135,5.08493243,3.19897814,3.20287191,6.38183901
,4.70341787,3.42941614,3.47124326,4.62179715,4.46194685
,3.19131053,2.20919558,3.83114715,4.34409484,4.33654264
,6.87033422,3.26621023,5.20122803,4.68844525,3.92141537
,4.97974672,4.19172539,4.31151147,4.64089418,2.82790249
,2.7481964, 3.81547895,5.93951329,4.25506516,3.87865117
,3.93040764,4.545346,5.81437241,2.70640118,3.82604712
,6.66537656,3.61110149,1.69158671,4.79237448,1.44131388
,3.16116185,3.59926929,2.93549916,4.33001274,3.84879647
,2.67977231,3.8572318, 4.27564335,3.2679062, 6.23886559
,4.9944987, 1.60880839,4.07013541,3.91741526,4.76351838
,5.40053503,3.5334187, 4.76292122,4.17375876,3.97258759
,3.78601532,3.94130634,2.50630286,7.15312829,3.30924682
,3.96479378,4.88042931,2.93709304,2.79260988,2.28642639
,5.12151922,3.23050664,4.90411262,3.75437165,2.57155484
,4.53916511,4.22706495,5.606811,2.64489191,4.5601503
,2.32630092,3.97981975,3.65943852,3.26093784,3.89233022
,4.26122548,3.08970908,4.24526432,3.13605187,3.71948156
,5.02157729,2.13665444,4.86794389,3.82463838,4.63096234
,5.60799131,4.16720818,4.07623141,4.50501515,3.68312093
,3.48272381,5.72193214,6.043501,3.34528944,3.71998038
,3.67469326,4.23746495,4.17065789,4.86472749,3.91627863
,2.82368796,4.20336347,4.07446614,5.03932996,3.57816241
,5.59735056,4.08817315,3.58362647,2.47827345,3.15037416
,4.13531666,1.38396794,5.36280207,3.01057009,4.13327812
,5.00221507,3.30217613,3.51662816,4.29273334,3.43266449
,4.6957561, 5.91390711,4.56575443,4.52007555,4.74217298
,2.64353243,3.20757086,4.41525302,2.41623492,3.41951762
,2.79507462,2.88515582,4.10950251,3.53168506,5.95191514
,3.18854676,3.14115452,4.19365923,2.11869939,3.97597212
,5.31631499,3.78800999,3.79247549,2.95875804,2.93631715
,3.79935826,3.55984431,4.18263542,4.38691857,4.79438799
,3.70599116,3.77730196,2.4158005, 1.24353946,2.93931328
,4.06583713,3.70024178,4.07150718,4.69058903,3.71489169
,4.37803885,4.30114308,3.57405983,2.61981627,3.83843845
,2.7219222, 4.78501216,5.70700607,4.18289124,3.53940228
,2.70132673,4.41354299,4.88362223,4.16103001,3.35954081
,4.83682386,3.69394391,3.24375426,4.80857385,4.06052424
,2.77271759,6.59304252,3.03171747,4.97606049,4.26844047
,4.51506249,3.43593317,3.41731759,3.38559083,3.45012167
,4.21112248,3.09518576,5.25169523,3.60374861,4.94123543
,4.47246377,5.92388537,5.4662164, 3.03108555,5.17696657
,5.25244305,2.18417556,3.58407704,4.01390698,3.68171863
,4.28096744,5.26940373,4.30863426,3.17347421,3.92981394
,3.74844967,3.90676976,3.69540628,1.89846559,4.48016163
,5.39660671,2.8107389, 4.00049964,4.36892152,3.40361642
,4.51560384,2.81035996,5.67636046,4.32514972,2.98989124
,4.3914684, 2.74227093,3.93873901,5.31033883,3.18656214
,5.01024788,1.8511542, 3.33966735,4.39252651,2.56002423
,4.29659128,3.79965961,4.55160529,2.06916945,4.61339133
,3.14878383,3.75017925,5.50877144,3.05242176,4.72515649
,5.07192201,3.52387396,4.46051854,2.45693068,4.14972318
,6.00675636,3.13928113,4.77784699,5.00884804,3.49535158
,2.39806565,4.0120877, 4.34927557,4.59691371,4.54542291
,5.97602601,2.52767008,5.77826123,5.57068538,3.67136351
,3.49631897,3.29008038,5.06684779,5.65994466,4.23506521
,3.01176872,4.27600171,3.78867639,4.34055387,3.41884208
,3.36457046,4.01926608,3.75358287,4.11662359,3.3631673
,5.80351515,4.24942792,2.9631048, 4.34701168,3.28798544
,5.11149043,4.24484008,3.90053124,5.35107263,2.15114835
,4.54531432,4.548927,5.02987023,3.73321618,2.98067318
,3.86142895,3.66210433,3.10458001,5.41651704,3.98671911
,3.20404522,4.36603785,4.19258931,2.50510782,2.42746053
,3.31154073,4.96919698,4.58226412,3.51287164,3.17707583
,4.45825584,2.7345212, 3.18256143,2.5995791, 4.36114526
,5.20142577,3.27013647,3.36053605,4.09783182,4.77902912
,4.03368451,2.75124634,1.50769743,4.35436193,4.95097831
,3.60967025,4.42524786,3.65513847,5.2693159, 3.41849793
,3.78004387,2.09032396,5.20212763,2.84264962,4.69867536
,4.48614909,4.57262696,2.63707437,4.64150696,3.70727712
,4.17888991,3.51194932,4.89340959,3.67780304,2.81036106
,6.12134155,2.40988586,2.99609231,4.1602831, 2.70969991
,4.88414913,1.94166604,2.29284339,4.41671771,4.35720116
,3.30967658,4.18069955,4.13617923,4.47774652,3.97660494
,3.78166186,5.08454149,5.36141372,4.5154576, 2.91240654
,3.75863755,3.50453414,3.07898095,2.98578988,3.30262947
,3.98405024,2.91376001,4.19142484,3.37225874,2.32793054
,4.66317143,4.74524999,4.62442852,4.27163504,5.05499498
,3.48106325,4.77536806,2.94794637,5.26306818,3.86978423
,4.84116132,5.0351833, 6.24641742,3.33420973,5.25185225
,3.78638659,4.69768311,3.23771542,3.76456555,4.51271559
,3.85698553,2.96486377,3.39002326,3.44032411,3.79917436
,5.02818549,4.30707647,4.07237742,5.22230669,5.02064482
,5.51527773,6.50425526,2.77569287,2.19340121,4.00386356
,3.98506494,3.5667977, 5.16732686,4.78571015,4.02292399
,5.22172598,3.75232234,3.77505277,5.09084184,4.62399366
,3.16782862,2.3487991, 4.60464158,4.45139632,3.10102287
,5.83545995,4.44542241,4.02214737,4.51650067,4.785272
,3.84563897,4.51772881,4.62590065,4.25481894,4.81527038
,2.79130178,4.39286214,3.49771614,3.54037344,4.70106948
,5.04940606,3.15401618,5.52518747,3.65021053,2.12851498
,5.41829551,4.69050303,4.87365542,4.44124202,3.52394396
,3.64662501,3.61728352,5.10102603,5.21541615,3.71801212
,4.88527448,2.90163088,4.96808262,2.98852388,7.164922
,4.87883728,3.82879968,2.69527696,2.61564739,4.52334225
,4.14073716,4.37731293,4.10464255,3.22216321,4.06087505
,3.79547438,5.40334492,5.2455048, 2.38943368,3.21378837
,4.43983813,2.85772096,5.0909155, 4.35474384,4.70596857
,1.82817017,5.41604838,3.56539847,4.3897794, 2.35300974
,4.40133514,3.82414879,4.36231429,2.9151823, 4.35381692
,5.43489867,4.02554905,3.40366916,5.17078241,5.04287095
,4.09477632,4.20707095,3.16788109,2.31284216,3.62375431
,2.86952665,3.32705655,4.8037043, 2.4712326, 3.54228835
,2.47656367,4.2401261, 4.12654625,3.70711133,5.81619121
,5.90131124,6.5215455, 5.89008055,9.13543455,8.42273503
,5.89701114,4.88558431,9.7989407, 6.19569189,7.76097723
,6.44358461,8.3776732, 2.57255118,7.39302296,9.1153393
,9.29833362,7.30812711,6.00313752,7.52776211,8.38903005
,8.07864179,7.82632378,8.10368811,10.94105107,6.99157184
,5.51170034,8.20085094,5.68107787,6.0470912, 7.47381262
,7.57721946,3.97141421,5.09799982,9.63711516,5.29378071
,5.85816785,2.28365599,8.28626535,7.23297867,6.36608927
,7.10995176,10.7074932, 8.71945758,7.38840445,10.0884164
,7.72466521,11.36042616,6.18523373,8.17558559,10.77238358
,7.18963291,7.52448456,11.46175425,7.0097434, 6.1592406
,9.55488772,10.63793735,7.96201934,7.95393759,8.4530337
,6.95669609,7.76285698,8.05225913,6.37938291,7.32801872
,7.85964348,5.34236521,3.11520468,6.45264296,7.64042341
,5.29813138,3.59555169,5.71964702,8.01411823,7.06283676
,8.41287964,7.0820878, 5.80671381,8.31980823,9.01409657
,4.2092875, 5.86041164,4.87363978,9.15841424,9.38079914
,3.5141527, 4.277895,5.89756322,3.73774322,6.99245445
,6.76235213,8.79834756,7.24215247,5.81574533,6.66605497
,4.79178625,7.53085208,8.72216491,4.97837516,7.83493674
,7.64317961,3.55200997,8.08401166,5.93229744,3.88776325
,8.70686846,8.07593332,6.89271278,5.71927554,7.66933473
,5.96156434,9.32385131,5.04556167,5.08874245,6.65389223
,9.52609868,5.30082757,8.23987642,5.45297606,8.10352583
,5.50530714,7.57234258,6.58122191,6.63878481,4.70213993
,5.55930788,6.15751316,3.5690273, 7.1011172, 7.15544095
,8.26791403,10.43085523,9.41700898,4.69959816,11.80273834
,10.57365582,6.01365754,5.96376535,6.43189691,6.51185468
,9.34497587,5.69742588,5.55756863,6.31794754,6.88219916
,13.76594949,10.29912821,6.94009549,4.36325834,9.71286838
,8.35752869,4.96592054,9.61651464,6.63231596,11.17806379
,7.53245572,5.09563576,3.61854691,9.22665373,3.47371006
,7.15129275,5.8104415, 3.24840236,8.94624515,4.2919363
,3.17603217,6.06288231,7.886799,5.73287155,7.80124139
,6.33146056,5.27818641,6.00936197,7.81147801,8.52284746
,2.394477,9.84705732,10.47972661,6.64041337,4.41489483
,8.88442926,9.62105512,5.03983289,7.13672146,9.75691756
,5.2882603, 4.33156344,5.66249761,8.49503618,7.57834725
,6.56641854,8.85392858,8.35260516,5.16614972,8.11748666
,4.75396864,4.09003343,7.88603206,5.42015341,6.41999114
,5.52521289,7.09778559,7.87335761,5.35953437,7.36275252
,5.63552366,6.60773181,6.29832802,10.05386669,7.54438631
,4.25065619,8.64506025,8.90903953,8.74363616,5.61430617
,7.40831149,8.79118184,6.08657835,9.22829838,7.99912415
,8.52306025,4.44179961,7.93724845,10.34971867,8.3861515
,5.4106296, 7.23992242,7.67310718,12.364368, 10.84137732
,11.96747224,9.05244308,8.70293144,9.62668677,7.26188888
,8.28676961,9.89041114,4.61952935,3.97183184,8.55213728
,7.94659031,7.28242102,7.86509754,6.10600049,12.54312173
,8.42504975,7.46521561,5.53000953,11.46233086,3.43141288
,11.22116274,9.65312721,9.06888279,9.79173071,8.00367109
,7.76701765,6.71607977,5.94569807,6.1801244, 8.15042241
,8.26717556,5.91007794,7.70129947,6.24086952,6.48741487
,5.8599868, 7.0207611, 5.4595458, 6.4608045, 7.37717378
,9.96925964,6.02657769,4.89740793,8.52361211,6.85457753
,8.92468425,7.61675411,4.58194815,6.52406485,8.47328388
,5.73946783,5.13366616,9.8959598, 8.30952329,6.16097291
,8.32906879,6.69771849,8.68169095,7.70316371,7.56033071
,6.52564096,7.47278185,7.08279377,9.3568184, 5.19290215
,5.58896995,8.80402912,7.02075673,9.39308892,3.19730501
,11.41228523,12.86209289,10.99177461,9.13628098,10.97618631
,8.32619269,13.53687657,11.50136843,14.64860571,13.41162668
,8.56413629,5.76423305,8.16113743,11.00106931,5.64735137
,11.71739314,3.40790619,13.74066081,6.14912847,0.11938045
,12.51210883,10.71867981,2.85440611,9.8712914, 8.9594293
,6.75276335,9.2432247,11.29182022,7.8711561, 7.8456051
,10.28750801,8.84106973,10.41768259,6.88046234,8.56289691
,6.27968727,9.55057681,7.74237562,11.12049693,7.20259053
,4.69853681,4.59482899,9.07851554,10.1072139,13.32901428
,11.36847274,12.65540187,8.22441799,11.73008618,12.60613321
,11.9772535,14.61927194,17.73237078,10.11432488,8.05944134
,11.51680692,8.35511658,8.58928893,7.30169812,10.453069
,4.55763614,8.74007817,4.79432583,11.23989459,11.88505908
,9.12427894,16.49449673,11.29976156,14.76108454,3.80898584
,7.18696577,6.77431759,18.03383087,14.42932615,13.82337282
,10.75411121,16.80291204,8.77901387,7.77681892,6.59228494
,10.34289694,11.5464465, 8.34770161,13.17985584,8.94191086
,13.53506829,10.0552611,11.94592142,7.44282088,7.34729258
,9.89807391,10.75221858,11.34927719,9.76196552,13.45099198
,12.38905113,11.91468699,7.87038135,4.21993857,8.71811882];


import Deeplearning;
import SaveData as SaveData;
import DistributionStatistics as DistributionStatistics;
import matplotlib.pyplot as plt;
import numpy as np;
import MixtureModel;


Traveltime = np.array(Traveltime);

Optimizer = Deeplearning.MLE();
Optimizer._Distribution = 'lognormal';
Optimizer._DataSize = len(Traveltime);

Optimizer.DefineFlow();

print('length of data = ', Optimizer._DataSize);
Mu, Sigma, Weight, Loglikelihood = Optimizer.Training(data = Traveltime);

Mu, Sigma, Weight, Loglikelihood = np.array(Mu), np.array(Sigma), np.array(Weight), np.array(Loglikelihood);

Mean = MixtureModel.SingleDistribution_Mean(Optimizer._Distribution, Mu, Sigma);
Std = MixtureModel.SingleDistribution_Std(Optimizer._Distribution, Mu, Sigma);
Skewness = MixtureModel.SingleDistribution_Skewness(Optimizer._Distribution, Sigma);

SampleMean = np.mean(Traveltime);
SampleVar = np.var(Traveltime);
SampleSkew = DistributionStatistics.Empirical_Skewness(Traveltime);
MM_Mean = DistributionStatistics.MixtureModel_Mean(Mean, Weight);
MM_Var = DistributionStatistics.MixtureModel_Var(Mean, Std, Weight);
MM_Skew = DistributionStatistics.MixtureModel_Skewness(Mean, Std, Skewness, Weight);

print(Mean, Std);
print(SampleMean, SampleVar, SampleSkew);
print(MM_Mean, MM_Var, MM_Skew);
print(Loglikelihood[-1]);

plt.plot(Loglikelihood);
plt.show();

plt.hist(Traveltime, bins=40, density=True);
X, Y = MixtureModel.MixturePDF(Traveltime, Optimizer._Distribution, Optimizer._NumComponent, Mu, Sigma, Weight);

plt.plot(X, Y, 'r');
plt.show();